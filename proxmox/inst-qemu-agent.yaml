---
# ğŸ§© Playbook: install_qemu_guest_agent.yml
# ğŸ“˜ Description:
# Installs the QEMU Guest Agent package on virtual machines to enable communication
# between the guest OS and its hypervisor (e.g., Proxmox, KVM, or QEMU).
# This agent allows clean shutdowns, IP address reporting, and consistent snapshots
# from the hypervisor interface.
#
# ğŸ”§ Notes:
# - Should only be installed on virtual machines (not on bare-metal hosts).
# - Requires sudo/root privileges.
# - Compatible with Debian/Ubuntu systems using `apt`.
# - To fully activate guest-agent features in Proxmox, enable â€œQEMU Guest Agentâ€
#   in the VMâ€™s hardware settings after running this playbook.
#
# ğŸ§  Example usage:
# ansible-playbook -i inventory.ini playbooks/proxmox/install_qemu_guest_agent.yml -e "target_group=VMs"

- name: Install qemu-guest-agent package
  hosts: "{{ target_group | d('all') }}"
  become: true
  become_method: ansible.builtin.sudo

  tasks:
    - name: Install qemu-guest-agent
      ansible.builtin.apt:
        name: qemu-guest-agent
        state: present
